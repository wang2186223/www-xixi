# é¦–é¡µåŠ¨æ€åˆ·æ–°æœºåˆ¶è¯´æ˜

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

ä¸ºäº†ç¡®ä¿ç”¨æˆ·æ¯æ¬¡è®¿é—®é¦–é¡µéƒ½èƒ½çœ‹åˆ°æœ€æ–°çš„å°è¯´å†…å®¹å’Œä¸åŒçš„Featured Novelsæ¨èï¼Œæˆ‘ä»¬å®ç°äº†ä¸¤ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼š

### 1. æ–°å°è¯´å¼ºåˆ¶åˆ·æ–°æœºåˆ¶ ğŸ”„
- **ç›®æ ‡**ï¼šæ¯æ¬¡ç”¨æˆ·è®¿é—®é¦–é¡µæ—¶è·å–æœ€æ–°å†…å®¹
- **æ–¹æ³•**ï¼šä½¿ç”¨URLç‰ˆæœ¬å‚æ•°ç»•è¿‡é¡µé¢ç¼“å­˜
- **ä¿æŠ¤**ï¼šä¸æ¸…é™¤ç”¨æˆ·æµè§ˆå™¨ç¼“å­˜ï¼Œä¿ç•™é˜…è¯»å†å²

### 2. Featured Novels åŠ¨æ€éšæœºåŒ– ğŸ²
- **ç›®æ ‡**ï¼šæ¯æ¬¡è®¿é—®éƒ½é‡æ–°éšæœºæ’åˆ—Featuredå°è¯´
- **æ–¹æ³•**ï¼šFisher-Yatesæ´—ç‰Œç®—æ³•é‡æ’åº
- **æ•ˆæœ**ï¼šä¼˜é›…çš„æ·¡å…¥æ·¡å‡ºåŠ¨ç”»æ•ˆæœ

## ğŸ”§ æŠ€æœ¯å®ç°

### å¼ºåˆ¶åˆ·æ–°æœºåˆ¶ (`ensureFreshContent`)

```javascript
function ensureFreshContent() {
    const urlParams = new URLSearchParams(window.location.search);
    const refreshParam = urlParams.get('v');
    const currentTime = new Date().getTime();
    
    // å¦‚æœæ²¡æœ‰ç‰ˆæœ¬å‚æ•°ï¼Œæˆ–ç‰ˆæœ¬å‚æ•°è¿‡æ—§ï¼ˆè¶…è¿‡1åˆ†é’Ÿï¼‰ï¼Œåˆ™åˆ·æ–°
    if (!refreshParam || (currentTime - parseInt(refreshParam)) > 60000) {
        const newUrl = window.location.pathname + '?v=' + currentTime;
        if (window.location.href !== window.location.origin + newUrl) {
            window.history.replaceState({}, '', newUrl);
            window.location.reload();
        }
    }
}
```

**å·¥ä½œåŸç†ï¼š**
1. æ£€æŸ¥URLä¸­çš„ç‰ˆæœ¬å‚æ•° `?v=timestamp`
2. å¦‚æœå‚æ•°ä¸å­˜åœ¨æˆ–è¶…è¿‡1åˆ†é’Ÿï¼Œæ·»åŠ æ–°çš„æ—¶é—´æˆ³
3. ä½¿ç”¨ `window.location.reload()` å¼ºåˆ¶è·å–æœ€æ–°å†…å®¹
4. ä¿æŒæµè§ˆå™¨ç¼“å­˜ï¼Œåªåˆ·æ–°é¡µé¢å†…å®¹

### Featured NovelséšæœºåŒ– (`shuffleFeaturedNovels`)

```javascript
function shuffleFeaturedNovels() {
    const featuredGrid = document.querySelector('.featured .cards-grid');
    if (!featuredGrid) return;

    const allCards = Array.from(featuredGrid.children);
    if (allCards.length <= 1) return;

    // Fisher-Yatesæ´—ç‰Œç®—æ³•
    for (let i = allCards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        featuredGrid.insertBefore(allCards[j], allCards[i].nextSibling);
    }

    // æ·»åŠ é‡æ–°åŠ è½½åŠ¨ç”»æ•ˆæœ
    featuredGrid.style.opacity = '0';
    setTimeout(() => {
        featuredGrid.style.transition = 'opacity 0.3s ease-in-out';
        featuredGrid.style.opacity = '1';
    }, 50);
}
```

**å·¥ä½œåŸç†ï¼š**
1. è·å–Featured NovelsåŒºåŸŸçš„æ‰€æœ‰å°è¯´å¡ç‰‡
2. ä½¿ç”¨Fisher-Yatesç®—æ³•éšæœºé‡æ’åº
3. æ·»åŠ æ·¡å…¥æ·¡å‡ºåŠ¨ç”»æå‡ç”¨æˆ·ä½“éªŒ
4. æ¯æ¬¡é¡µé¢åŠ è½½éƒ½ä¼šé‡æ–°éšæœºæ’åˆ—

## ğŸ“‹ æ‰§è¡Œæµç¨‹

```
ç”¨æˆ·è®¿é—®é¦–é¡µ
     â†“
é¡µé¢å¼€å§‹åŠ è½½
     â†“
DOMContentLoadedè§¦å‘
     â†“
æ‰§è¡ŒensureFreshContent()
     â†“ (æ£€æŸ¥URLç‰ˆæœ¬å‚æ•°)
éœ€è¦åˆ·æ–°ï¼Ÿ â†’ æ˜¯ â†’ æ·»åŠ æ—¶é—´æˆ³å¹¶é‡æ–°åŠ è½½
     â†“ å¦
ç»§ç»­æ‰§è¡Œ
     â†“
å»¶è¿Ÿ500msæ‰§è¡ŒshuffleFeaturedNovels()
     â†“
éšæœºé‡æ’Featured Novels
     â†“
æ·»åŠ æ·¡å…¥åŠ¨ç”»
     â†“
å®Œæˆ
```

## ğŸ¨ ç”¨æˆ·ä½“éªŒ

### é¦–æ¬¡è®¿é—®
1. é¡µé¢æ­£å¸¸åŠ è½½
2. URLè‡ªåŠ¨æ·»åŠ ç‰ˆæœ¬å‚æ•°ï¼ˆå¦‚ï¼š`/?v=1726297845123`ï¼‰
3. Featured Novelséšæœºæ’åˆ—æ˜¾ç¤º

### å†æ¬¡è®¿é—®ï¼ˆ1åˆ†é’Ÿå†…ï¼‰
1. é¡µé¢å¿«é€ŸåŠ è½½ï¼ˆåˆ©ç”¨ç¼“å­˜ï¼‰
2. ä¸è§¦å‘å¼ºåˆ¶åˆ·æ–°
3. Featured Novelsé‡æ–°éšæœºæ’åˆ—

### å†æ¬¡è®¿é—®ï¼ˆ1åˆ†é’Ÿåï¼‰
1. è§¦å‘å¼ºåˆ¶åˆ·æ–°è·å–æœ€æ–°å†…å®¹
2. URLç‰ˆæœ¬å‚æ•°æ›´æ–°
3. Featured Novelsé‡æ–°éšæœºæ’åˆ—

## âš¡ æ€§èƒ½ä¼˜åŒ–

### é˜²æŠ–æœºåˆ¶
- **1åˆ†é’Ÿé˜²æŠ–**ï¼šé¿å…é¢‘ç¹åˆ·æ–°
- **ä¼šè¯å­˜å‚¨**ï¼šåŒä¸€ä¼šè¯å†…æ™ºèƒ½æ§åˆ¶

### åŠ¨ç”»ä¼˜åŒ–
- **å»¶è¿Ÿæ‰§è¡Œ**ï¼š500mså»¶è¿Ÿç¡®ä¿DOMå®Œå…¨åŠ è½½
- **çŸ­åŠ¨ç”»**ï¼š300msæ·¡å…¥æ·¡å‡ºï¼Œä¸å½±å“ä½“éªŒ
- **ä¼˜é›…é™çº§**ï¼šå¦‚æœåŠ¨ç”»ä¸æ”¯æŒï¼ŒåŠŸèƒ½ä»ç„¶æ­£å¸¸

### ç¼“å­˜ç­–ç•¥
- **ä¿ç•™ç”¨æˆ·æ•°æ®**ï¼šlocalStorageä¸­çš„é˜…è¯»å†å²ä¸å—å½±å“
- **æ™ºèƒ½åˆ·æ–°**ï¼šåªåœ¨å¿…è¦æ—¶è·å–æ–°å†…å®¹
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šé€šè¿‡URLå‚æ•°ç²¾ç¡®æ§åˆ¶ç¼“å­˜

## ğŸ” æµè§ˆå™¨å…¼å®¹æ€§

- âœ… Chrome 60+
- âœ… Firefox 55+
- âœ… Safari 12+
- âœ… Edge 79+
- âœ… ç§»åŠ¨æµè§ˆå™¨å®Œå…¨æ”¯æŒ

## ğŸ“Š ç›‘æ§æŒ‡æ ‡

å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç›‘æ§åŠŸèƒ½æ•ˆæœï¼š

### Google Analyticsäº‹ä»¶
- é¡µé¢åˆ·æ–°é¢‘ç‡
- Featured Novelsç‚¹å‡»ç‡
- ç”¨æˆ·åœç•™æ—¶é—´

### å¼€å‘è€…å·¥å…·æ£€æŸ¥
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°æ£€æŸ¥
console.log('URLå‚æ•°:', new URLSearchParams(window.location.search).get('v'));
console.log('Featured Novelsæ•°é‡:', document.querySelectorAll('.featured .novel-card').length);
```

## ğŸ›ï¸ å¯è°ƒæ•´å‚æ•°

### åˆ·æ–°é—´éš”
åœ¨ `ensureFreshContent()` å‡½æ•°ä¸­ä¿®æ”¹ï¼š
```javascript
// å½“å‰ï¼š1åˆ†é’Ÿ = 60000
// æ”¹ä¸º30ç§’ï¼š30000
// æ”¹ä¸º5åˆ†é’Ÿï¼š300000
if (!refreshParam || (currentTime - parseInt(refreshParam)) > 60000) {
```

### åŠ¨ç”»å»¶è¿Ÿ
åœ¨ `DOMContentLoaded` äº‹ä»¶ä¸­ä¿®æ”¹ï¼š
```javascript
// å½“å‰ï¼š500ms
// æ”¹ä¸º1ç§’ï¼š1000
// æ”¹ä¸ºç«‹å³ï¼š0
setTimeout(shuffleFeaturedNovels, 500);
```

---

*è¯¥åŠŸèƒ½å·²é›†æˆåˆ°é¦–é¡µæ¨¡æ¿ä¸­ï¼Œç¡®ä¿æ¯æ¬¡ç”¨æˆ·è®¿é—®éƒ½èƒ½è·å¾—æœ€æ–°ã€æœ€å¤šæ ·åŒ–çš„å†…å®¹ä½“éªŒã€‚*
